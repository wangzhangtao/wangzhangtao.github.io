<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Python操作Excel | 蚂蚁博客</title><meta name="description" content="Python操作Excel简介基础环境 Python版本号 3.6.8 pip版本号 20.1.1  python中与excel操作相关的模块 xlrd库：只能读excel，支持xls、xlsx xlwt库：只能写excel，支持xls, 不支持对xlsx格式的修改，excel 的单格内容长度上限32767 xlutils库：结合xlrd，对一个已存在的文件进行修改，需要注意的是你必须同时安装这三"><meta name="keywords" content="python,excel"><meta name="author" content="会跳的小蚂蚁"><meta name="copyright" content="会跳的小蚂蚁"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Python操作Excel"><meta name="twitter:description" content="Python操作Excel简介基础环境 Python版本号 3.6.8 pip版本号 20.1.1  python中与excel操作相关的模块 xlrd库：只能读excel，支持xls、xlsx xlwt库：只能写excel，支持xls, 不支持对xlsx格式的修改，excel 的单格内容长度上限32767 xlutils库：结合xlrd，对一个已存在的文件进行修改，需要注意的是你必须同时安装这三"><meta name="twitter:image" content="http://wang.ikongjian.com/img/gkihqEjXxJ5UZ1C.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Python操作Excel"><meta property="og:url" content="http://wang.ikongjian.com/2020/07/30/python%E6%93%8D%E4%BD%9Cexcel/"><meta property="og:site_name" content="蚂蚁博客"><meta property="og:description" content="Python操作Excel简介基础环境 Python版本号 3.6.8 pip版本号 20.1.1  python中与excel操作相关的模块 xlrd库：只能读excel，支持xls、xlsx xlwt库：只能写excel，支持xls, 不支持对xlsx格式的修改，excel 的单格内容长度上限32767 xlutils库：结合xlrd，对一个已存在的文件进行修改，需要注意的是你必须同时安装这三"><meta property="og:image" content="http://wang.ikongjian.com/img/gkihqEjXxJ5UZ1C.jpg"><meta property="article:published_time" content="2020-07-30T02:00:00.000Z"><meta property="article:modified_time" content="2020-07-30T11:22:53.715Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://wang.ikongjian.com/2020/07/30/python%E6%93%8D%E4%BD%9Cexcel/"><link rel="prev" title="dockerfile的使用" href="http://wang.ikongjian.com/2020/07/30/dockerfile%E7%9A%84%E4%BD%BF%E7%94%A8/"><link rel="next" title="pod的使用" href="http://wang.ikongjian.com/2020/07/28/pod%E7%9A%84%E4%BD%BF%E7%94%A8/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: true
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">91</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">48</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">40</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/2020/07/01/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Python操作Excel简介"><span class="toc-number">1.</span> <span class="toc-text">Python操作Excel简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基础环境"><span class="toc-number">1.1.</span> <span class="toc-text">基础环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#python中与excel操作相关的模块"><span class="toc-number">1.2.</span> <span class="toc-text">python中与excel操作相关的模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#关于xlrd-xlwt和openpyxl的差别"><span class="toc-number">1.2.1.</span> <span class="toc-text">关于xlrd&#x2F;xlwt和openpyxl的差别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装和excel相关python类"><span class="toc-number">1.3.</span> <span class="toc-text">安装和excel相关python类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#python-xlrd-xlwt使用"><span class="toc-number">2.</span> <span class="toc-text">python xlrd&#x2F;xlwt使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#写Excel"><span class="toc-number">2.1.</span> <span class="toc-text">写Excel</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#使用循环方式写入内容："><span class="toc-number">2.1.1.</span> <span class="toc-text">使用循环方式写入内容：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#读Excel"><span class="toc-number">2.2.</span> <span class="toc-text">读Excel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改Excel"><span class="toc-number">2.3.</span> <span class="toc-text">修改Excel</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#excel和数据库"><span class="toc-number">3.</span> <span class="toc-text">excel和数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#在mysql中添加测试库"><span class="toc-number">3.1.</span> <span class="toc-text">在mysql中添加测试库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#从excel读取数据写入数据库"><span class="toc-number">3.2.</span> <span class="toc-text">从excel读取数据写入数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#从数据库读入数据-写入xls"><span class="toc-number">3.3.</span> <span class="toc-text">从数据库读入数据,写入xls</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Python-Openpyxl使用"><span class="toc-number">4.</span> <span class="toc-text">Python Openpyxl使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#openpyxl对Excel的操作命令"><span class="toc-number">4.1.</span> <span class="toc-text">openpyxl对Excel的操作命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#openpyxl-写入excel"><span class="toc-number">4.2.</span> <span class="toc-text">openpyxl 写入excel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#openpyxl-读取excel"><span class="toc-number">4.3.</span> <span class="toc-text">openpyxl 读取excel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#访问单元格"><span class="toc-number">4.4.</span> <span class="toc-text">访问单元格</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#单一单元格访问"><span class="toc-number">4.4.1.</span> <span class="toc-text">单一单元格访问</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#多单元格访问"><span class="toc-number">4.4.2.</span> <span class="toc-text">多单元格访问</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#保存数据"><span class="toc-number">4.5.</span> <span class="toc-text">保存数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他方法"><span class="toc-number">4.6.</span> <span class="toc-text">其他方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设置单元格风格"><span class="toc-number">4.7.</span> <span class="toc-text">设置单元格风格</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#结束"><span class="toc-number">5.</span> <span class="toc-text">结束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#参考文档"><span class="toc-number">5.1.</span> <span class="toc-text">参考文档</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/gkihqEjXxJ5UZ1C.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">蚂蚁博客</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/2020/07/01/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Python操作Excel</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-07-30 10:00:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-07-30</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-07-30 19:22:53"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-07-30</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/python/">python</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">3.2k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 13 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="Python操作Excel简介"><a href="#Python操作Excel简介" class="headerlink" title="Python操作Excel简介"></a>Python操作Excel简介</h2><h3 id="基础环境"><a href="#基础环境" class="headerlink" title="基础环境"></a>基础环境</h3><ul>
<li>Python版本号 3.6.8</li>
<li>pip版本号 20.1.1</li>
</ul>
<h3 id="python中与excel操作相关的模块"><a href="#python中与excel操作相关的模块" class="headerlink" title="python中与excel操作相关的模块"></a>python中与excel操作相关的模块</h3><ul>
<li><a href="http://pypi.python.org/pypi/xlrd" target="_blank" rel="noopener">xlrd库</a>：只能读excel，支持xls、xlsx</li>
<li><a href="http://pypi.python.org/pypi/xlwt" target="_blank" rel="noopener">xlwt库</a>：只能写excel，支持xls, 不支持对xlsx格式的修改，excel 的单格内容长度上限32767</li>
<li><a href="https://pypi.python.org/pypi/xlutils" target="_blank" rel="noopener">xlutils库</a>：结合xlrd，对一个已存在的文件进行修改，需要注意的是你必须同时安装这三个库, (xlutils提供方法帮助你把xlrd.Book对象复制到xlwt.Workbook对象)</li>
<li><a href="http://openpyxl.readthedocs.org/" target="_blank" rel="noopener">OpenPyXL</a>：主要针对xlsx格式的excel进行读取和编辑，不支持xls</li>
<li>xlsxwriter：可以写excel文件并加上图表，缺点是不能打开/修改已有文件，意味着使用 xlsxwriter 需要从零开始。</li>
</ul>
<h4 id="关于xlrd-xlwt和openpyxl的差别"><a href="#关于xlrd-xlwt和openpyxl的差别" class="headerlink" title="关于xlrd/xlwt和openpyxl的差别"></a>关于xlrd/xlwt和openpyxl的差别</h4><p>两者都是对于excel文件的操作插件，两者的主要区别在于写入操作，其中xlwt针对Ecxec2007之前的版本，即.xls文件，其要求单个sheet不超过65535行，而openpyxl则主要针对Excel2007之后的版本（.xlsx），它对文件大小没有限制。另外还有区别就是二者在读写速度上的差异，xlrd/xlwt在读写方面的速度都要优于openpyxl，但因为xlwt无法生成xlsx是个硬伤，所以想要尽量提高效率又不影响结果时，可以考虑用xlrd读取，用openpyxl写入。</p>
<h3 id="安装和excel相关python类"><a href="#安装和excel相关python类" class="headerlink" title="安装和excel相关python类"></a>安装和excel相关python类</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pip install xlrd  </span><br><span class="line">pip install xlwt </span><br><span class="line">pip install xlutils  </span><br><span class="line">pip install openpyxl</span><br></pre></td></tr></table></figure>



<h2 id="python-xlrd-xlwt使用"><a href="#python-xlrd-xlwt使用" class="headerlink" title="python xlrd/xlwt使用"></a>python xlrd/xlwt使用</h2><h3 id="写Excel"><a href="#写Excel" class="headerlink" title="写Excel"></a>写Excel</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import xlwt  #引入模块</span><br><span class="line"></span><br><span class="line">book1 &#x3D; xlwt.Workbook()   #创建 excel</span><br><span class="line">sheet &#x3D; book1.add_sheet(&#39;sheet1&#39;)   #创建sheet页</span><br><span class="line"></span><br><span class="line">sheet.write(0,0,&#39;名字&#39;)   #编辑表头</span><br><span class="line">sheet.write(1,0,&#39;王一&#39;)   #编辑内容</span><br><span class="line">sheet.write(2,0,&#39;王二&#39;)</span><br><span class="line"></span><br><span class="line">sheet.write(0,1,&#39;手机号&#39;)  #编辑表头</span><br><span class="line">sheet.write(1,1,&#39;119&#39;)    #编辑内容</span><br><span class="line">sheet.write(2,1,&#39;110&#39;)</span><br><span class="line"></span><br><span class="line">book1.save(&quot;students1.xls&quot;)  #保存下，xlsx也可以保存，但会打不开，使用wps可以打开，使用微软的会打不开</span><br></pre></td></tr></table></figure>

<p>保存的时候，如果是微软的office,后缀.xls<br>保存的时候，如果是wps .xls .xlsx都可以</p>
<h4 id="使用循环方式写入内容："><a href="#使用循环方式写入内容：" class="headerlink" title="使用循环方式写入内容："></a>使用循环方式写入内容：</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#给定文件内容：</span><br><span class="line">stus&#x3D; [</span><br><span class="line">    [&#39;id&#39;, &#39;name&#39;, &#39;sex&#39;, &#39;age&#39;, &#39;addr&#39;, &#39;grade&#39;, &#39;phone&#39;, &#39;gold&#39;],</span><br><span class="line">    [314, &#39;矿泉水&#39;, &#39;男&#39;, 18, &#39;北京市昌平区&#39;, &#39;摩羯座&#39;, &#39;18317155663&#39;, 14405],</span><br><span class="line">    [315, &#39;矿泉水&#39;, &#39;女&#39;, 27, &#39;上海&#39;, &#39;摩羯座&#39;, &#39;18317155664&#39;, 100]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">#内容写入Excel</span><br><span class="line">book2&#x3D;xlwt.Workbook()  #新建一个Excel</span><br><span class="line">sheet2&#x3D;book2.add_sheet(&#39;sheet1&#39;)  #新建一个sheet页</span><br><span class="line"></span><br><span class="line">row &#x3D; 0  #行号</span><br><span class="line">for stu in stus:  #控制行</span><br><span class="line">    col &#x3D; 0#列号</span><br><span class="line">    for field in stu:  #控制列的</span><br><span class="line">        sheet2.write(row,col,field)</span><br><span class="line">        col+&#x3D;1  #列号</span><br><span class="line">    row+&#x3D;1</span><br><span class="line"></span><br><span class="line">book2.save(&#39;students2.xls&#39;)  #保存内容</span><br></pre></td></tr></table></figure>



<h3 id="读Excel"><a href="#读Excel" class="headerlink" title="读Excel"></a>读Excel</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import xlrd</span><br><span class="line"></span><br><span class="line">book3&#x3D;xlrd.open_workbook(&#39;students1.xls&#39;) #打开Excel</span><br><span class="line">sheet3&#x3D;book3.sheet_by_index(0) #根据编号获取sheet页</span><br><span class="line">#sheet&#x3D;book3.sheet_by_name(&#39;sheet1&#39;) #也可以根据sheet页名字获取sheet页</span><br><span class="line"></span><br><span class="line">print(sheet3.nrows) #Excel里有多少行</span><br><span class="line">print(sheet3.ncols)  #Excel里有多少列</span><br><span class="line"></span><br><span class="line">print(sheet.cell(0,0).value) #获取到指定单元格的内容</span><br><span class="line">print(sheet.cell(0,1).value) #获取到指定单元格的内容</span><br><span class="line"></span><br><span class="line">print(sheet.row_values(0))  #获取到整行的内容</span><br><span class="line">print(sheet.col_values(0))   #获取到整列的内容</span><br><span class="line"></span><br><span class="line">for i in range(sheet.nrows):  #循环获取每行的内容</span><br><span class="line">    print(sheet.row_values(i))</span><br></pre></td></tr></table></figure>



<h3 id="修改Excel"><a href="#修改Excel" class="headerlink" title="修改Excel"></a>修改Excel</h3><p>由于xlwt模块只能写一次，再重新打开Excel后会覆盖原来的内容；而xlrd模块只能读，因此修改Excel就要使用xlutils模块了</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import xlrd   #两个模块配合使用</span><br><span class="line">import xlutils</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">book4 &#x3D; xlrd.open_workbook(&#39;students1.xls&#39;)  #先用xlrd打开一个Excel</span><br><span class="line">new_book4 &#x3D; xlutils.copy.copy(book4)  #然后用xlutils里面的copy功能，复制一个Excel</span><br><span class="line"></span><br><span class="line">sheet4 &#x3D; new_book4.get_sheet(0)  #获取sheet页，注意这里的sheet 页是xlutils里的，只能用.get_sheet()的方法获取了</span><br><span class="line">sheet4.write(0,0,&#39;ID&#39;)  # 第一行，第一列</span><br><span class="line"></span><br><span class="line">os.rename(&#39;students1.xls&#39;,&#39;students1_bak.xls&#39;) #先把之前的Excel改下名字，之前的内容不至于丢失</span><br><span class="line">new_book4.save(&#39;students1.xls&#39;) #修改完内容后再保存成同名的Excel</span><br></pre></td></tr></table></figure>

<p>​    如果是单个模块：from xlutils import copy</p>
<h2 id="excel和数据库"><a href="#excel和数据库" class="headerlink" title="excel和数据库"></a>excel和数据库</h2><h3 id="在mysql中添加测试库"><a href="#在mysql中添加测试库" class="headerlink" title="在mysql中添加测试库"></a>在mysql中添加测试库</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">create database od;</span><br><span class="line">use od;</span><br><span class="line"></span><br><span class="line">grant  all on od.* to &#39;oldboy&#39;@&#39;%&#39; identified by &#39;oldboy123&#39;;</span><br><span class="line"></span><br><span class="line">create table stu (</span><br><span class="line">    id int(10) NOT NULL AUTO_INCREMENT,</span><br><span class="line">    name varchar(100) ,</span><br><span class="line">    school varchar(100) ,</span><br><span class="line">    PRIMARY KEY (&#96;id&#96;) </span><br><span class="line">ENGINE&#x3D;InnoDB AUTO_INCREMENT&#x3D;1 DEFAULT CHARSET&#x3D;utf8 COLLATE&#x3D;utf8_unicode_ci;</span><br><span class="line"></span><br><span class="line">insert into stu(name, school) values(&quot;zhangsan&quot;, &quot;三中&quot;);</span><br><span class="line">insert into stu(name, school) values(&quot;lisi&quot;, &quot;四中&quot;);</span><br><span class="line">select * from stu;</span><br></pre></td></tr></table></figure>

<p># alter table stu add column school varchar(255) ;<br># alter table stu change column sex school varchar(255) ;</p>
<h3 id="从excel读取数据写入数据库"><a href="#从excel读取数据写入数据库" class="headerlink" title="从excel读取数据写入数据库"></a>从excel读取数据写入数据库</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import xlwt</span><br><span class="line">import xlrd</span><br><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line">#从excel读取数据写入mysql</span><br><span class="line">def excel_to_mysql(filename):</span><br><span class="line">    conn &#x3D; pymysql.connect(host&#x3D;&#39;mysql.od.com&#39;,port&#x3D;3306, user&#x3D;&#39;oldboy&#39;, password&#x3D;&#39;oldboy123&#39;,db&#x3D;&#39;od&#39;,charset&#x3D;&#39;utf8&#39;)</span><br><span class="line">    cur &#x3D; conn.cursor()     #连接数据库</span><br><span class="line">    book &#x3D; xlrd.open_workbook(filename)</span><br><span class="line">    sheet1 &#x3D; book.sheet_by_name(&#39;sheet1&#39;)</span><br><span class="line">    rows &#x3D; sheet1.nrows      #获取行数</span><br><span class="line">    for r in range(1,rows):  #将标题之外的其他行写入数据库</span><br><span class="line">        r_values &#x3D; sheet1.row_values(r)</span><br><span class="line">        sql &#x3D; &#39;insert into stu(name, school) values(%s,%s)&#39; #有几个字段需要几个%s</span><br><span class="line">        data &#x3D; cur.execute(sql,r_values)  #将每一行插入sql</span><br><span class="line">    conn.commit()           #插入所有数据后提交</span><br><span class="line">    cur.close()</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line">excel_to_mysql(&#39;students1.xls&#39;)</span><br></pre></td></tr></table></figure>



<h3 id="从数据库读入数据-写入xls"><a href="#从数据库读入数据-写入xls" class="headerlink" title="从数据库读入数据,写入xls"></a>从数据库读入数据,写入xls</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import xlwt</span><br><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line">def sql_connect(sql):</span><br><span class="line">    conn &#x3D; pymysql.connect(host&#x3D;&#39;mysql.od.com&#39;,port&#x3D;3306, user&#x3D;&#39;oldboy&#39;, password&#x3D;&#39;oldboy123&#39;,db&#x3D;&#39;od&#39;,charset&#x3D;&#39;utf8&#39;)</span><br><span class="line">    cur &#x3D; conn.cursor()</span><br><span class="line">    cur.execute(sql)</span><br><span class="line">    data &#x3D; cur.fetchall()</span><br><span class="line">    cur.close()</span><br><span class="line">    conn.close()</span><br><span class="line">    return data</span><br><span class="line"></span><br><span class="line">sql2 &#x3D; &quot;select * from stu limit 10;&quot;</span><br><span class="line">stus &#x3D; sql_connect(sql2)</span><br><span class="line"></span><br><span class="line">#内容写入Excel</span><br><span class="line">book2&#x3D;xlwt.Workbook()  #新建一个Excel</span><br><span class="line">sheet2&#x3D;book2.add_sheet(&#39;sheet1&#39;)  #新建一个sheet页</span><br><span class="line"></span><br><span class="line">row &#x3D; 0  #行号</span><br><span class="line">for stu in stus:  #控制行</span><br><span class="line">    col &#x3D; 0#列号</span><br><span class="line">    for field in stu:  #控制列的</span><br><span class="line">        sheet2.write(row,col,field)</span><br><span class="line">        col+&#x3D;1  #列号</span><br><span class="line">    row+&#x3D;1</span><br><span class="line"></span><br><span class="line">book2.save(&#39;students2.xls&#39;)  #保存内容</span><br></pre></td></tr></table></figure>



<h2 id="Python-Openpyxl使用"><a href="#Python-Openpyxl使用" class="headerlink" title="Python Openpyxl使用"></a>Python Openpyxl使用</h2><h3 id="openpyxl对Excel的操作命令"><a href="#openpyxl对Excel的操作命令" class="headerlink" title="openpyxl对Excel的操作命令"></a>openpyxl对Excel的操作命令</h3><ul>
<li>创建一个工作薄：wb = openpyxl.Workbook()</li>
<li>激活工作薄: wb.active</li>
<li>插入数据: ws[‘A1’] = 42， 或者 ws.append([1, 2, 3])</li>
<li>写入第一行、第三列的数据 value = ‘result’：ws.cell(row = 1,column = 3,value = ‘result’)</li>
<li>新增一个sheet表单：wb.create_sheet(‘Mysheet1’)</li>
<li>保存case.xlsx文件：wb.save(‘cases.xlsx’)</li>
<li>关闭工作薄：wb.close()</li>
</ul>
<ul>
<li>打开工作簿：wb = openpyxl.load_workbook(‘cases.xlsx’)</li>
<li>选取表单：sh = wb[‘sheet1’]</li>
<li>显示表名：print(wb.sheetnames)</li>
<li>读取第一行、第一列的数据：ce = ws(row = 1,column = 1)</li>
<li>按行读取数据：row_data = list(ws.rows)</li>
<li>按列读取数据：columns_data = list(ws.columns)</li>
</ul>
<ul>
<li><strong>写入数据之前，该文件一定要处于关闭状态</strong></li>
<li>获取最大行总数、最大列总数：print(ws.max_row, ws.max_column)</li>
<li>remove 删除表单的用法：sh = wb[‘sheet_name’] wb.remove(sh) </li>
</ul>
<h3 id="openpyxl-写入excel"><a href="#openpyxl-写入excel" class="headerlink" title="openpyxl 写入excel"></a>openpyxl 写入excel</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import openpyxl</span><br><span class="line">import datetime</span><br><span class="line"></span><br><span class="line">wb &#x3D; openpyxl.Workbook()  # 实例化</span><br><span class="line">ws &#x3D; wb.active  # 激活 worksheet</span><br><span class="line"></span><br><span class="line">ws[&#39;A1&#39;] &#x3D; 42  # 方式一：数据可以直接分配到单元格中(可以输入公式)</span><br><span class="line">ws[&#39;B1&#39;] &#x3D; datetime.datetime.now().strftime(&quot;%Y-%m-%d&quot;)  # Python 类型会被自动转换</span><br><span class="line">ws.cell(row &#x3D; 1,column &#x3D; 3,value &#x3D; &#39;result&#39;)  # 方式二：通过cell</span><br><span class="line">ws.append([1, 2, 3])  # 方式三：可以附加行，从第一列开始附加(从最下方空白处，最左开始)(可以输入多行)</span><br><span class="line">ws.append([&quot;wang&quot;, &quot;zhang&quot;, &quot;li&quot;])  </span><br><span class="line"></span><br><span class="line">ws1 &#x3D; wb.create_sheet(&quot;Mysheet1&quot;)  # 方式一：插入到最后(default) </span><br><span class="line">ws2 &#x3D; wb.create_sheet(&quot;Mysheet2&quot;, 1)  # 方式二：插入到最开始的位置</span><br><span class="line">ws2[&#39;A1&#39;] &#x3D; &quot;ws2&quot;</span><br><span class="line"></span><br><span class="line">wb.save(&#39;cases.xlsx&#39;)  # 保存为一个xlsx格式的文件</span><br><span class="line">wb.close()  # 关闭工作薄</span><br></pre></td></tr></table></figure>



<h3 id="openpyxl-读取excel"><a href="#openpyxl-读取excel" class="headerlink" title="openpyxl 读取excel"></a>openpyxl 读取excel</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import openpyxl</span><br><span class="line"></span><br><span class="line">wb &#x3D; openpyxl.load_workbook(&#39;cases.xlsx&#39;)  # 第一步：打开工作簿</span><br><span class="line">ws &#x3D; wb[&#39;Sheet&#39;]  # 第二步：选取表单</span><br><span class="line"></span><br><span class="line">print(wb.sheetnames)  # 显示所有表名</span><br><span class="line">for sheet in wb:  # 遍历所有表</span><br><span class="line">    print(sheet.title)</span><br><span class="line"></span><br><span class="line">ce &#x3D; ws.cell(row &#x3D; 1,column &#x3D; 1)   # 参数 row:行,column：列; 读取第一行，第一列的数据</span><br><span class="line">print(ce.value)</span><br><span class="line"></span><br><span class="line">print(list(ws.rows)[1:])     # 按行读取数据，去掉第一行的表头信息数据</span><br><span class="line">for cases in list(ws.rows)[1:]:</span><br><span class="line">    case_id &#x3D;  cases[0].value</span><br><span class="line">    case_excepted &#x3D; cases[1].value</span><br><span class="line">    case_data &#x3D; cases[2].value</span><br><span class="line">    print(case_id,case_excepted,case_data)</span><br><span class="line"></span><br><span class="line">print(list(ws.rows)[1:])  # 按列读取数据</span><br></pre></td></tr></table></figure>



<h3 id="访问单元格"><a href="#访问单元格" class="headerlink" title="访问单元格"></a>访问单元格</h3><h4 id="单一单元格访问"><a href="#单一单元格访问" class="headerlink" title="单一单元格访问"></a>单一单元格访问</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">c &#x3D; ws[&#39;A1&#39;]</span><br><span class="line">d &#x3D; ws.cell(row&#x3D;4, column&#x3D;2, value&#x3D;11)</span><br><span class="line">print(c.value, d.value)</span><br><span class="line"></span><br><span class="line">for i in range(1,5):</span><br><span class="line">    for j in range(1,5):</span><br><span class="line">        ws.cell(row&#x3D;i, column&#x3D;j).value</span><br></pre></td></tr></table></figure>

<h4 id="多单元格访问"><a href="#多单元格访问" class="headerlink" title="多单元格访问"></a>多单元格访问</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cell_range &#x3D; ws[&#39;A1&#39;:&#39;C2&#39;]  # 通过切片</span><br><span class="line">colC &#x3D; ws[&#39;C&#39;]  # 通过行(列)</span><br><span class="line">col_range &#x3D; ws[&#39;C:D&#39;]</span><br><span class="line">row10 &#x3D; ws[10]</span><br><span class="line">row_range &#x3D; ws[5:10]</span><br><span class="line"></span><br><span class="line"># 通过指定范围(行 → 行)</span><br><span class="line">for row in ws.iter_rows(min_row&#x3D;1, max_col&#x3D;3, max_row&#x3D;2):</span><br><span class="line">    for cell in row:</span><br><span class="line">        print(cell.value)</span><br><span class="line"></span><br><span class="line"># 通过指定范围(列 → 列)</span><br><span class="line">for col in ws.iter_cols(min_row&#x3D;1, max_col&#x3D;3, max_row&#x3D;2):</span><br><span class="line">    for cell in col:</span><br><span class="line">        print(cell.value)</span><br><span class="line"></span><br><span class="line">tuple(ws.rows)  # 遍历所有 方法一</span><br><span class="line">tuple(ws.columns)  # 遍历所有 方法二</span><br></pre></td></tr></table></figure>

<h3 id="保存数据"><a href="#保存数据" class="headerlink" title="保存数据"></a>保存数据</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wb.save(&#39;cases.xlsx&#39;)  # 保存为一个xlsx格式的文件</span><br><span class="line">wb.close()  # 关闭工作薄</span><br></pre></td></tr></table></figure>



<h3 id="其他方法"><a href="#其他方法" class="headerlink" title="其他方法"></a>其他方法</h3><p>改变 sheet 标签按钮颜色</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ws.sheet_properties.tabColor &#x3D; &quot;1072BA&quot;</span><br></pre></td></tr></table></figure>

<p>获取最大行，最大列</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">print(ws.max_row)</span><br><span class="line">print(ws.max_column)</span><br></pre></td></tr></table></figure>

<p>获取每一行，每一列</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ws.rows为生成器, 里面是每一行的数据，每一行又由一个tuple包裹。</span><br><span class="line">ws.columns类似，不过里面是每个tuple是每一列的单元格。</span><br><span class="line"># 因为按行，所以返回A1, B1, C1这样的顺序</span><br><span class="line">for row in ws.rows:</span><br><span class="line">  for cell in row:</span><br><span class="line">    print(cell.value)</span><br><span class="line"> </span><br><span class="line"># A1, A2, A3这样的顺序</span><br><span class="line">for column in ws.columns:</span><br><span class="line">  for cell in column:</span><br><span class="line">    print(cell.value)</span><br></pre></td></tr></table></figure>

<p>根据数字得到字母，根据字母得到数字</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">from openpyxl.utils import get_column_letter, column_index_from_string</span><br><span class="line"> </span><br><span class="line"># 根据列的数字返回字母</span><br><span class="line">print(get_column_letter(2)) # B</span><br><span class="line"># 根据字母返回列的数字</span><br><span class="line">print(column_index_from_string(&#39;D&#39;)) # 4</span><br></pre></td></tr></table></figure>

<p> 删除工作表（待验证）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wb.remove_sheet(&quot;Mysheet1&quot;)  # 方式一,我推荐</span><br><span class="line">del wb[sheet]  # 方式二</span><br></pre></td></tr></table></figure>

<p> 矩阵置换（行 → 列）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rows &#x3D; [</span><br><span class="line">  [&#39;Number&#39;, &#39;data1&#39;, &#39;data2&#39;],</span><br><span class="line">  [2, 40, 30],</span><br><span class="line">  [3, 40, 25],</span><br><span class="line">  [4, 50, 30],</span><br><span class="line">  [7, 50, 10]]</span><br><span class="line"> </span><br><span class="line">list(zip(*rows))</span><br><span class="line"> </span><br><span class="line"># out</span><br><span class="line">[(&#39;Number&#39;, 2, 3, 4, 7), (&#39;data1&#39;, 40, 40, 50, 50), (&#39;data2&#39;, 30, 25, 30, 10)]</span><br><span class="line"> </span><br><span class="line"># 注意 方法会舍弃缺少数据的列(行)</span><br><span class="line">rows &#x3D; [</span><br><span class="line">  [&#39;Number&#39;, &#39;data1&#39;, &#39;data2&#39;],</span><br><span class="line">  [2, 40  ], # 这里少一个数据</span><br><span class="line">  [3, 40, 25],</span><br><span class="line">  [4, 50, 30],</span><br><span class="line">  [7, 50, 10],</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">list(zip(*rows))</span><br><span class="line"># out</span><br><span class="line">[(&#39;Number&#39;, 2, 3, 4, 7), (&#39;data1&#39;, 40, 40, 50, 50)]</span><br></pre></td></tr></table></figure>

<h3 id="设置单元格风格"><a href="#设置单元格风格" class="headerlink" title="设置单元格风格"></a>设置单元格风格</h3><p>① 需要导入的类</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">from openpyxl.styles import Font, colors, Alignment</span><br></pre></td></tr></table></figure>

<p>② 字体</p>
<p>下面的代码指定了等线24号，加粗斜体，字体颜色红色。直接使用cell的font属性，将Font对象赋值给它。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bold_itatic_24_font &#x3D; Font(name&#x3D;&#39;等线&#39;, size&#x3D;24, italic&#x3D;True, color&#x3D;colors.BLUE, bold&#x3D;True)</span><br><span class="line"> </span><br><span class="line">ws[&#39;A1&#39;].font &#x3D; bold_itatic_24_font</span><br></pre></td></tr></table></figure>

<p>③ 对齐方式</p>
<p>也是直接使用cell的属性aligment，这里指定垂直居中和水平居中。除了center，还可以使用right、left等等参数。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 设置B1中的数据垂直居中和水平居中</span><br><span class="line">ws[&#39;B1&#39;].alignment &#x3D; Alignment(horizontal&#x3D;&#39;center&#39;, vertical&#x3D;&#39;center&#39;)</span><br></pre></td></tr></table></figure>

<p>④ 设置行高和列宽</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ws.row_dimensions[2].height &#x3D; 40  # 第2行行高</span><br><span class="line">ws.column_dimensions[&#39;C&#39;].width &#x3D; 30  # C列列宽</span><br></pre></td></tr></table></figure>

<p>⑤ 合并和拆分单元格</p>
<ul>
<li>所谓合并单元格，即以合并区域的左上角的那个单元格为基准，覆盖其他单元格使之称为一个大的单元格。</li>
<li>相反，拆分单元格后将这个大单元格的值返回到原来的左上角位置。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 合并单元格， 往左上角写入数据即可</span><br><span class="line">ws.merge_cells(&#39;B1:G1&#39;) # 合并一行中的几个单元格</span><br><span class="line">ws.merge_cells(&#39;A1:C3&#39;) # 合并一个矩形区域中的单元格</span><br></pre></td></tr></table></figure>

<ul>
<li>合并后只可以往左上角写入数据，也就是区间中:左边的坐标。</li>
<li>如果这些要合并的单元格都有数据，只会保留左上角的数据，其他则丢弃。换句话说若合并前不是在左上角写入数据，合并后单元格中不会有数据。</li>
<li>以下是拆分单元格的代码。拆分后，值回到A1位置。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sheet.unmerge_cells(&#39;A1:C3&#39;)</span><br></pre></td></tr></table></figure>

<p>最后举个例子</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import datetime</span><br><span class="line">from random import choice</span><br><span class="line">from time import time</span><br><span class="line">from openpyxl import load_workbook</span><br><span class="line">from openpyxl.utils import get_column_letter</span><br><span class="line"></span><br><span class="line">addr &#x3D; &quot;openpyxl.xlsx&quot;  # 设置文件 mingc</span><br><span class="line">wb &#x3D; load_workbook(addr)  # 打开文件</span><br><span class="line">ws &#x3D; wb.create_sheet()  # 创建一张新表</span><br><span class="line">ws.append([&#39;TIME&#39;, &#39;TITLE&#39;, &#39;A-Z&#39;])  # 第一行输入</span><br><span class="line"></span><br><span class="line"># 输入内容（50行数据）</span><br><span class="line">for i in range(50):</span><br><span class="line">  TIME &#x3D; datetime.datetime.now().strftime(&quot;%H:%M:%S&quot;)</span><br><span class="line">  TITLE &#x3D; str(time())</span><br><span class="line">  A_Z &#x3D; get_column_letter(choice(range(1, 10)))</span><br><span class="line">  ws.append([TIME, TITLE, A_Z])</span><br><span class="line"></span><br><span class="line">row_max &#x3D; ws.max_row  # 获取最大行</span><br><span class="line">con_max &#x3D; ws.max_column  # 获取最大列</span><br><span class="line"></span><br><span class="line"># 把上面写入内容打印在控制台</span><br><span class="line">for j in ws.rows: # we.rows 获取每一行数据</span><br><span class="line">  for n in j:</span><br><span class="line">    print(n.value, end&#x3D;&quot;\t&quot;)  # n.value 获取单元格的值</span><br><span class="line">  print()</span><br><span class="line"></span><br><span class="line">wb.save(addr)  # 保存，save（必须要写文件名（绝对地址）默认 py 同级目录下，只支持 xlsx 格式）</span><br></pre></td></tr></table></figure>



<h2 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h2><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul>
<li>官网网址：<a href="http://www.python-exceel.org/" target="_blank" rel="noopener">http://www.python-exceel.org/</a></li>
<li><a href="https://www.cnblogs.com/brf-test/p/11748442.html" target="_blank" rel="noopener">Python之操作Excel</a> ， 内容：xlrd和xlwt的使用</li>
<li><a href="https://www.jianshu.com/p/d596ba8931ee" target="_blank" rel="noopener">Python 针对Excel操作</a>   ， 内容：xlrd和xlwt结合数据库进行读写</li>
<li><a href="http://www.52codes.net/develop/shell/58896.html" target="_blank" rel="noopener">浅谈Python_Openpyxl使用</a> ， 内容：Openpyxl的使用</li>
<li><a href="https://blog.gocalf.com/python-read-write-excel" target="_blank" rel="noopener">用 Python 读写 Excel 文件</a>  ， 内容：xlrd和xlwt，OpenPyXL 和 XlsxWriter 的优缺点（适应场景）</li>
</ul>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">会跳的小蚂蚁</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://wang.ikongjian.com/2020/07/30/python%E6%93%8D%E4%BD%9Cexcel/">http://wang.ikongjian.com/2020/07/30/python%E6%93%8D%E4%BD%9Cexcel/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://wang.ikongjian.com" target="_blank">蚂蚁博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/python/">python</a><a class="post-meta__tags" href="/tags/excel/">excel</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付宝"/><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><div class="post-ad"><ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="xxxxxxxxxxxx" data-ad-client="ca-pub-xxxxxxxxxx" data-ad-slot="xxxxxxxxxx"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/07/30/dockerfile%E7%9A%84%E4%BD%BF%E7%94%A8/"><img class="prev_cover" src="/img/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">dockerfile的使用</div></div></a></div><div class="next-post pull_right"><a href="/2020/07/28/pod%E7%9A%84%E4%BD%BF%E7%94%A8/"><img class="next_cover" src="/img/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">pod的使用</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/06/29/python经验收集/" title="Python经验收集"><img class="relatedPosts_cover" src="/img/gkihqEjXxJ5UZ1C.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-06-29</div><div class="relatedPosts_title">Python经验收集</div></div></a></div><div class="relatedPosts_item"><a href="/2020/07/15/体验python魔力/" title="体验python魔力"><img class="relatedPosts_cover" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-07-15</div><div class="relatedPosts_title">体验python魔力</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
var requiredFields = requestSetting(['nick','mail','link'],'nick,mail')

window.valine = new Valine({
  el:'#vcomment',
  appId: '3trHicwpGcV9ectvS8IUTPyA-gzGzoHsz',
  appKey: 'O89QU06amIo1zHhNLV9BMxU7',
  notify: false,
  verify: false,
  placeholder: 'Please leave your footprints',
  avatar: 'monsterid',
  meta: guestInfo,
  pageSize: '10',
  lang: 'en',
  recordIP: false,
  serverURLs: '',
  emojiCDN: '',
  emojiMaps: "",
  enableQQ: false,
  requiredFields: requiredFields
});</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By 会跳的小蚂蚁</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="icp"><a href="http://www.beian.gov.cn/portal/index.do" target="_blank" rel="noopener"><img class="icp-icon" src="/img/icp.png"/><span>京ICP备20023989号</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script defer id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script></body></html>